{{ define "index" }}
<html>
<head>
    <script src="https://code.jquery.com/jquery-3.4.1.min.js"
            integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo="
            crossorigin="anonymous"></script>

{{/*    <link href="https://fonts.googleapis.com/css?family=Roboto&display=swap" rel="stylesheet">*/}}
{{/*    <style>*/}}
{{/*        body {*/}}
{{/*            font-family: "Roboto", sans-serif;*/}}
{{/*            background-color: #e0e0e0;*/}}
{{/*            color: #333;*/}}
{{/*        }*/}}
{{/*    </style>*/}}

    <link href="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.css" rel="stylesheet">
    <script src="https://unpkg.com/material-components-web@latest/dist/material-components-web.min.js"></script>
    <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons">
</head>
<body>
    <h1>OWasp Threat Test</h1>
    <div class="message">
        <h2>Headers</h2>
        <p style="display: none">{{ .Headers }}</p>
    </div>
    <div class="message">
        <h2>Cookies</h2>
        <p style="display: none">{{ .Cookies }}</p>
    </div>
    <div class="message">
        <h1>GET Variables</h1>
        <p>
            {{ .GetVar }}
        </p>
    </div>
    <div class="message">
        <h1>POST Variables</h1>
        <p>
            {{ .PostVar }}
        </p>
    </div>
    <form action="/">
        <div class="mdc-text-field mdc-text-field--textarea">
            <textarea id="formvar" id="formvar" name="formvar" class="mdc-text-field__input" rows="8" cols="40"></textarea>
            <div class="mdc-notched-outline">
                <div class="mdc-notched-outline__leading"></div>
                <div class="mdc-notched-outline__notch">
                    <label for="formvar" class="mdc-floating-label"></label>
                </div>
                <div class="mdc-notched-outline__trailing"></div>
            </div>
        </div>
        <div>
            <button id="postbtn" class="mdc-button mdc-button--outlined"><span class="mdc-button__label">POST</span></button>
            <button id="getbtn" class="mdc-button mdc-button--outlined"><span class="mdc-button__label">GET</span></button>
        </div>
        <div>
            <ul>
                <li><a href="#" id="owasp-xss">XSS Attack</a></li>
                <li><a href="#" id="owasp-sqli">SQLi Attack</a></li>
            </ul>
        </div>
    </form>
</body>
<script>
    $(function() {
        $('#postbtn').click(function() {
            $('form')[0].method='POST'
            $('form').submit()
        })
        $('#getbtn').click(function() {
            $('form')[0].method='GET'
            $('form').submit()
        })
        $('#owasp-xss').click(function() {
            $('#formvar')[0].value = '< script>alert(\'XSS Attack success\')< \/script>'.replace(/< /g, '<')
            return false
        })
        $('#owasp-sqli').click(function() {
            $('#formvar')[0].value = '\'; DROP TABLE \'accounts\';'
            return false
        })
    })
</script>
</html>
{{ end }}